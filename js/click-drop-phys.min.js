function round(a){return.5+a|0}function randInt(a,e){return Math.floor(Math.random()*(e-a+1)+a)}function loadImage(a,e){var i={};i.canvas=document.createElement("canvas"),i.ctx=i.canvas.getContext("2d");var o=new Image;return o.onload=function(){var a=o.width/o.height;i.canvas.width=2*e*a,i.canvas.height=2*e,i.ctx.drawImage(o,0,0,i.canvas.width,i.canvas.height)},o.src=a,i}function Box(a,e,i,o,t){this.body=null,this.width=e,this.height=i;var n=new b2BodyDef;n.type=b2Body.b2_dynamicBody,n.position.x=o,n.position.y=t,this.body=a.CreateBody(n);var r=new b2PolygonShape;r.SetAsBox(e,i,.5);var s=new b2FixtureDef;s.shape=r,s.density=1,this.body.CreateFixture(s)}function CachedImageBox(a,e,i,o,t){this.image=e;var n=new b2BodyDef;n.type=b2Body.b2_dynamicBody,n.position.x=i,n.position.y=o,this.body=a.CreateBody(n);var r=new b2FixtureDef;r.shape=new b2PolygonShape;var s=this.image.canvas.width/(2*t),c=this.image.canvas.height/(2*t);r.shape.SetAsBox(s,c,.5),r.density=1,this.body.CreateFixture(r)}function clickDropInit(a){(clickDropVariables={}).scale=a.scale,clickDropVariables.images=new Array,a.images.forEach(function(a){clickDropVariables.images.push(loadImage(a,clickDropVariables.scale))}),clickDropVariables.things=new Array,clickDropVariables.world=new b2World(new b2Vec2(0,50),!0),clickDropVariables.canvas=document.createElement("canvas"),clickDropVariables.canvas.style.position="fixed",clickDropVariables.canvas.style.top="0px",clickDropVariables.canvas.style.left="0px",clickDropVariables.canvas.style.zIndex=3,clickDropVariables.canvas.style.pointerEvents="none",clickDropVariables.ctx=clickDropVariables.canvas.getContext("2d"),document.getElementsByTagName("body")[0].appendChild(clickDropVariables.canvas),window.onmousedown=function(a){var e=new CachedImageBox(world,clickDropVariables.images[randInt(0,clickDropVariables.images.length-1)],a.clientX/clickDropVariables.scale,a.clientY/clickDropVariables.scale,clickDropVariables.scale);clickDropVariables.things.push(e);var i=10*randInt(-100,100)/clickDropVariables.scale,o=10*randInt(-500,-100)/clickDropVariables.scale;e.body.ApplyImpulse(new b2Vec2(i,o),e.body.GetWorldCenter()),e.body.ApplyTorque(randInt(-500,500))},window.onresize=function(){clickDropVariables.canvas.width=window.innerWidth,clickDropVariables.canvas.height=window.innerHeight},window.onresize(),world=new b2World(new b2Vec2(0,40),!0),window.setInterval(function(){clickDropVariables.ctx.clearRect(0,0,clickDropVariables.canvas.width,clickDropVariables.canvas.height),world.Step(1/60,10,10),clickDropVariables.things.forEach(function(a){a.render(clickDropVariables.ctx,clickDropVariables.scale)}),world.ClearForces()},1e3/60)}var b2Vec2=Box2D.Common.Math.b2Vec2,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2Body=Box2D.Dynamics.b2Body,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2Fixture=Box2D.Dynamics.b2Fixture,b2World=Box2D.Dynamics.b2World,b2MassData=Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2Transform=Box2D.Common.Math.b2Transform,b2Mat22=Box2D.Common.Math.b2Mat22;Box.prototype.render=function(a,e){var i=this.body.GetPosition();a.save(),a.strokeStyle="#000000",a.translate(i.x*e,i.y*e),a.rotate(this.body.GetAngle()),a.beginPath(),a.moveTo(-1*this.width*e,-1*this.height*e),a.lineTo(this.width*e,-1*this.height*e),a.lineTo(this.width*e,this.height*e),a.lineTo(-1*this.width*e,this.height*e),a.lineTo(-1*this.width*e,-1*this.height*e),a.closePath(),a.stroke(),a.restore()},CachedImageBox.prototype.render=function(a,e){var i=this.body.GetPosition();a.save(),a.translate(i.x*e,i.y*e),a.rotate(this.body.GetAngle()),a.drawImage(this.image.canvas,-1*round(this.image.canvas.width/2),-1*round(this.image.canvas.height/2)),a.restore()};var clickDropVariables=null;